---
layout: post
title: "Java 高级操作"
category: java
---

Java 语法的高级操作

### 优先队列

逆序优先队列 

    PriorityQueue<Integer> pq = new PriorityQueue<Integer>(initCapacity, Collections.reverseOrder());

内部类做Comparater的有限队列:
    
    PriorityQueue<Integer> pq = new PriorityQueue<Integer>(10,
        new Comparator<Integer>(){
            @Override
            public int compare(Integer o1, Integer o2) {
                return o2.compareTo(o1);//ascend order
            }
    });

### Shuffle

`java.util.Collections`中提供了随机重排数组的方法`shuffle(List<?> list)`

随机重排算法要求每个元素出现在每个位置的概率相等，随机过程很简单：逆序遍历数组，每次从前n个元素中随机选取一个和第n个交换位置

    for (int i=size; i>1; i--)
      swap(list, i-1, rnd.nextInt(i));

但这里要考虑list是不是可以随机访问的，如果是`LinkedList`，则需要先转化为`ArrayList`，否则上面的算法需要`O(n^2)`的时间复杂度，完整代码如下：

    public static void shuffle(List<?> list, Random rnd) {
        int size = list.size();
        if (size < SHUFFLE_THRESHOLD || list instanceof RandomAccess) {
            for (int i=size; i>1; i--)
                swap(list, i-1, rnd.nextInt(i));
        } else {
            Object arr[] = list.toArray();

            // Shuffle array
            for (int i=size; i>1; i--)
                swap(arr, i-1, rnd.nextInt(i));

            // Dump array back into list
            ListIterator it = list.listIterator();
            for (int i=0; i<arr.length; i++) {
                it.next();
                it.set(arr[i]);
            }
        }
    }
